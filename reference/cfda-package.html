<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Categorical Functional Data Analysis — cfda-package • cfda</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Categorical Functional Data Analysis — cfda-package"><meta property="og:description" content="cfda provides functions for the analysis of categorical functional data.
The main contribution is the computation of an optimal encoding (real functional variable) of each state of the categorical
functional data.
This can be done using the compute_optimal_encoding function that takes in arguments the data in a specific
format and a basis of functions created using the fda package (cf. create.basis).
The output can be analysed with summary.fmca, plot.fmca, get_encoding,
plotEigenvalues and plotComponent.
Moreover, cfda contains functions to visualize and compute some statistics about categorical functional data.
A summary of the dataset is available with summary_cfd.
plotData shows a graphical representation of the dataset.
Basic statistics can be computed: the number of jumps (compute_number_jumps), the duration
(compute_duration), the time spent in each state (compute_time_spent),
the probability to be in each state at any given time (estimate_pt), the transition table
(statetable).
The parameters of a Markov process can be estimated using estimate_Markov function.
In order to test the different functions, a real dataset is provided (biofam2) as well as two functions
for generating data: (generate_Markov and generate_2State)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cfda</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.11.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/cfda.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/modal-inria/cfda/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Categorical Functional Data Analysis</h1>
    <small class="dont-index">Source: <a href="https://github.com/modal-inria/cfda/blob/HEAD/R/cfda-package.R" class="external-link"><code>R/cfda-package.R</code></a></small>
    <div class="hidden name"><code>cfda-package.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>cfda provides functions for the analysis of categorical functional data.</p>
<p>The main contribution is the computation of an optimal encoding (real functional variable) of each state of the categorical
functional data.
This can be done using the <code><a href="compute_optimal_encoding.html">compute_optimal_encoding</a></code> function that takes in arguments the data in a specific
format and a basis of functions created using the <code>fda</code> package (cf. <code>create.basis</code>).
The output can be analysed with <code><a href="summary.fmca.html">summary.fmca</a></code>, <code><a href="plot.fmca.html">plot.fmca</a></code>, <code><a href="get_encoding.html">get_encoding</a></code>,
<code><a href="plotEigenvalues.html">plotEigenvalues</a></code> and <code><a href="plotComponent.html">plotComponent</a></code>.</p>
<p>Moreover, <code>cfda</code> contains functions to visualize and compute some statistics about categorical functional data.
A summary of the dataset is available with <code><a href="summary_cfd.html">summary_cfd</a></code>.
<code><a href="plotData.html">plotData</a></code> shows a graphical representation of the dataset.
Basic statistics can be computed: the number of jumps (<code><a href="compute_number_jumps.html">compute_number_jumps</a></code>), the duration
(<code><a href="compute_duration.html">compute_duration</a></code>), the time spent in each state (<code><a href="compute_time_spent.html">compute_time_spent</a></code>),
the probability to be in each state at any given time (<code><a href="estimate_pt.html">estimate_pt</a></code>), the transition table
(<code><a href="statetable.html">statetable</a></code>).</p>
<p>The parameters of a Markov process can be estimated using <code><a href="estimate_Markov.html">estimate_Markov</a></code> function.</p>
<p>In order to test the different functions, a real dataset is provided (<code><a href="biofam2.html">biofam2</a></code>) as well as two functions
for generating data: (<code><a href="generate_Markov.html">generate_Markov</a></code> and <code><a href="generate_2State.html">generate_2State</a></code>).</p>
    </div>


    <div id="details">
    <h2>Details</h2>
    <p>See the vignette for a detailed example and mathematical background:
<code>RShowDoc("cfda", package = "cfda")</code></p>
    </div>
    <div id="references">
    <h2>References</h2>
    
<ul><li><p>Deville J.C. (1982) Analyse de données chronologiques qualitatives : comment analyser des calendriers ?,
Annales de l'INSEE, No 45, p. 45-104.</p></li>
<li><p>Deville J.C. et  Saporta G. (1980) Analyse harmonique qualitative, DIDAY et al. (editors),
Data Analysis and Informatics, North Holland, p. 375-389.</p></li>
<li><p>Saporta G. (1981) Méthodes exploratoires d'analyse de données temporelles, Cahiers du B.U.R.O,
Université Pierre et Marie Curie, 37-38, Paris.</p></li>
<li><p>Preda C, Grimonprez Q, Vandewalle V. Categorical Functional Data Analysis. The cfda R Package.
Mathematics. 2021; 9(23):3074. https://doi.org/10.3390/math9233074</p></li>
</ul></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="compute_optimal_encoding.html">compute_optimal_encoding</a></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Simulate the Jukes-Cantor model of nucleotide replacement</span></span></span>
<span class="r-in"><span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fl">4</span></span></span>
<span class="r-in"><span><span class="va">Tmax</span> <span class="op">&lt;-</span> <span class="fl">5</span></span></span>
<span class="r-in"><span><span class="va">PJK</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">3</span>, nrow <span class="op">=</span> <span class="va">K</span>, ncol <span class="op">=</span> <span class="va">K</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">3</span>, <span class="va">K</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lambda_PJK</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d_JK</span> <span class="op">&lt;-</span> <span class="fu"><a href="generate_Markov.html">generate_Markov</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span>, K <span class="op">=</span> <span class="va">K</span>, P <span class="op">=</span> <span class="va">PJK</span>, lambda <span class="op">=</span> <span class="va">lambda_PJK</span>, Tmax <span class="op">=</span> <span class="va">Tmax</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d_JK2</span> <span class="op">&lt;-</span> <span class="fu"><a href="cut_data.html">cut_data</a></span><span class="op">(</span><span class="va">d_JK</span>, <span class="va">Tmax</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># create basis object</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">5</span></span></span>
<span class="r-in"><span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu">create.bspline.basis</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">Tmax</span><span class="op">)</span>, nbasis <span class="op">=</span> <span class="va">m</span>, norder <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compute encoding</span></span></span>
<span class="r-in"><span><span class="va">encoding</span> <span class="op">&lt;-</span> <span class="fu"><a href="compute_optimal_encoding.html">compute_optimal_encoding</a></span><span class="op">(</span><span class="va">d_JK2</span>, <span class="va">b</span>, computeCI <span class="op">=</span> <span class="cn">FALSE</span>, nCores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ######### Compute encoding #########</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of individuals: 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of states: 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Basis type: bspline</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of basis functions: 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of cores: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                  | 0 % elapsed=00s     |==========                                        | 20% elapsed=00s, remaining~00s  |====================                              | 40% elapsed=00s, remaining~00s  |==============================                    | 60% elapsed=00s, remaining~00s  |========================================          | 80% elapsed=00s, remaining~00s  |==================================================| 100% elapsed=00s, remaining~00s</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DONE in 0.08s</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---- Compute U matrix:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                  | 0 % elapsed=00s     |====                                              | 7 % elapsed=00s, remaining~00s  |=======                                           | 13% elapsed=00s, remaining~00s  |==========                                        | 20% elapsed=00s, remaining~00s  |==============                                    | 27% elapsed=00s, remaining~00s  |=================                                 | 33% elapsed=00s, remaining~00s  |====================                              | 40% elapsed=00s, remaining~00s  |========================                          | 47% elapsed=00s, remaining~00s  |===========================                       | 53% elapsed=00s, remaining~00s  |==============================                    | 60% elapsed=00s, remaining~00s  |==================================                | 67% elapsed=00s, remaining~00s  |=====================================             | 73% elapsed=00s, remaining~00s  |========================================          | 80% elapsed=00s, remaining~00s  |============================================      | 87% elapsed=00s, remaining~00s  |===============================================   | 93% elapsed=00s, remaining~00s  |==================================================| 100% elapsed=00s, remaining~00s</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DONE in 0.41s</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---- Compute encoding: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DONE in 0s</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run Time: 0.5s</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">encoding</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> #### FMCA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ## Data </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of individuals: 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of states: 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Time Range: 0 to 5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> States:  1 2 3 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ## Basis </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Type: bspline </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of basis functions: 5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ## Outputs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2.829354 2.282478 1.799415 1.469461 0.8318814 0.5187159 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Explained variance:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.279 0.504 0.682 0.827 0.909 0.96 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal encoding:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                1           2          3           4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  0.07724101 -0.08412610 -0.9027121  2.12720845</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.25779381 -0.02334159 -0.1051384 -0.06511869</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  0.67368417  1.95592737 -0.8359562 -0.52846472</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.37502000  0.52170320  0.7508660 -0.91307196</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]  0.60975716 -0.85600285  0.5711580 -0.46221971</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Principal components:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          [,1]       [,2]       [,3]        [,4]        [,5]        [,6]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  0.39384758  0.5060123 -0.5843695  0.10808683 -0.11784780 -0.92015914</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  2.68821991  0.2163696  3.0389829 -0.72581432 -0.06233262  0.05730442</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -1.95315107  0.8408190  0.4365884 -0.44306349  0.47350431 -1.06325243</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  0.03479717 -3.8778186 -0.5971048 -1.00341518  0.69688666 -0.08205782</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 -1.47492477 -1.0091604  0.4422508  0.71320378 -2.28927560  0.22667263</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 -1.81422297  0.6278327  0.3942427 -0.06794839  0.82622991  1.54360109</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total elapsed time: 0.495 s</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot eigenvalues</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plotEigenvalues.html">plotEigenvalues</a></span><span class="op">(</span><span class="va">encoding</span>, cumulative <span class="op">=</span> <span class="cn">TRUE</span>, normalize <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cfda-package-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot the two first components</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plotComponent.html">plotComponent</a></span><span class="op">(</span><span class="va">encoding</span>, comp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cfda-package-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot the encoding using the first harmonic</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">encoding</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 50 rows containing missing values (`geom_line()`).</span>
<span class="r-plt img"><img src="cfda-package-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># extract the encoding using the first harmonic</span></span></span>
<span class="r-in"><span><span class="va">encod</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_encoding.html">get_encoding</a></span><span class="op">(</span><span class="va">encoding</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Cristian Preda, Quentin Grimonprez.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

