<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Categorical Functional Data Analysis — cfda-package • cfda</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Categorical Functional Data Analysis — cfda-package" />
<meta property="og:description" content="cfda provides functions for the analysis of categorical functional data.
The main contribution is the computation of an optimal encoding (real functional variable) of each state of the categorical functional data.
This can be done using the compute_optimal_encoding function that takes in arguments the data in a specific format and
a basis of functions created using the fda package (cf. create.basis). The output can be analysed with summary.fmca, 
plot.fmca, get_encoding, plotEigenvalues and plotComponent.
Moreover, cfda contains functions to visualize and compute some statistics about categorical functional data. 
A summary of the dataset is available with summary_cfd.
plotData shows a graphical representation of the dataset. 
Basic statistics can be computed: the number of jumps (compute_number_jumps), the duration (compute_duration), 
the time spent in each state (compute_time_spent), the probability to be in each state at any given time (estimate_pt),
the transition table (statetable).
The parameters of a Markov process can be estimated using estimate_Markov function.
In order to test the different functions, a real dataset is provided (biofam2) as well as two functions for generating data: 
(generate_Markov and generate_2State)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cfda</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/cfda.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/modal-inria/cfda/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Categorical Functional Data Analysis</h1>
    <small class="dont-index">Source: <a href='https://github.com/modal-inria/cfda/blob/master/R/cfda-package.R'><code>R/cfda-package.R</code></a></small>
    <div class="hidden name"><code>cfda-package.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>cfda provides functions for the analysis of categorical functional data.</p>
<p>The main contribution is the computation of an optimal encoding (real functional variable) of each state of the categorical functional data.
This can be done using the <code><a href='compute_optimal_encoding.html'>compute_optimal_encoding</a></code> function that takes in arguments the data in a specific format and
a basis of functions created using the <code>fda</code> package (cf. <code>create.basis</code>). The output can be analysed with <code><a href='summary.fmca.html'>summary.fmca</a></code>, 
<code><a href='plot.fmca.html'>plot.fmca</a></code>, <code><a href='get_encoding.html'>get_encoding</a></code>, <code><a href='plotEigenvalues.html'>plotEigenvalues</a></code> and <code><a href='plotComponent.html'>plotComponent</a></code>.</p>
<p>Moreover, <code>cfda</code> contains functions to visualize and compute some statistics about categorical functional data. 
A summary of the dataset is available with <code><a href='summary_cfd.html'>summary_cfd</a></code>.
<code><a href='plotData.html'>plotData</a></code> shows a graphical representation of the dataset. 
Basic statistics can be computed: the number of jumps (<code><a href='compute_number_jumps.html'>compute_number_jumps</a></code>), the duration (<code><a href='compute_duration.html'>compute_duration</a></code>), 
the time spent in each state (<code><a href='compute_time_spent.html'>compute_time_spent</a></code>), the probability to be in each state at any given time (<code><a href='estimate_pt.html'>estimate_pt</a></code>),
the transition table (<code><a href='statetable.html'>statetable</a></code>).</p>
<p>The parameters of a Markov process can be estimated using <code><a href='estimate_Markov.html'>estimate_Markov</a></code> function.</p>
<p>In order to test the different functions, a real dataset is provided (<code><a href='biofam2.html'>biofam2</a></code>) as well as two functions for generating data: 
(<code><a href='generate_Markov.html'>generate_Markov</a></code> and <code><a href='generate_2State.html'>generate_2State</a></code>).</p>
    </div>



    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>See the vignette for a detailed example and mathematical background:
<code><a href='https://rdrr.io/r/utils/RShowDoc.html'>RShowDoc("cfda", package = "cfda")</a></code></p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    
<ul>
<li><p>Deville J.C. (1982) Analyse de données chronologiques qualitatives : comment analyser des calendriers ?, Annales de l'INSEE, No 45, p. 45-104.</p></li>
<li><p>Deville J.C. et  Saporta G. (1980) Analyse harmonique qualitative, DIDAY et al. (editors), Data Analysis and Informatics, North Holland, p. 375-389.</p></li>
<li><p>Saporta G. (1981) Méthodes exploratoires d'analyse de données temporelles, Cahiers du B.U.R.O, Université Pierre et Marie Curie, 37-38, Paris.</p></li>
</ul>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='compute_optimal_encoding.html'>compute_optimal_encoding</a></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Simulate the Jukes-Cantor model of nucleotide replacement  </span>
<span class='va'>K</span> <span class='op'>&lt;-</span> <span class='fl'>4</span>
<span class='va'>Tmax</span> <span class='op'>&lt;-</span> <span class='fl'>6</span>
<span class='va'>PJK</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>/</span><span class='fl'>3</span>, nrow <span class='op'>=</span> <span class='va'>K</span>, ncol <span class='op'>=</span> <span class='va'>K</span><span class='op'>)</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>/</span><span class='fl'>3</span>, <span class='va'>K</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>lambda_PJK</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>
<span class='va'>d_JK</span> <span class='op'>&lt;-</span> <span class='fu'><a href='generate_Markov.html'>generate_Markov</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>10</span>, K <span class='op'>=</span> <span class='va'>K</span>, P <span class='op'>=</span> <span class='va'>PJK</span>, lambda <span class='op'>=</span> <span class='va'>lambda_PJK</span>, Tmax <span class='op'>=</span> <span class='va'>Tmax</span><span class='op'>)</span>
<span class='va'>d_JK2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='cut_data.html'>cut_data</a></span><span class='op'>(</span><span class='va'>d_JK</span>, <span class='va'>Tmax</span><span class='op'>)</span>

<span class='co'># create basis object</span>
<span class='va'>m</span> <span class='op'>&lt;-</span> <span class='fl'>6</span>
<span class='va'>b</span> <span class='op'>&lt;-</span> <span class='fu'>create.bspline.basis</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='va'>Tmax</span><span class='op'>)</span>, nbasis <span class='op'>=</span> <span class='va'>m</span>, norder <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span>

<span class='co'># compute encoding</span>
<span class='va'>encoding</span> <span class='op'>&lt;-</span> <span class='fu'><a href='compute_optimal_encoding.html'>compute_optimal_encoding</a></span><span class='op'>(</span><span class='va'>d_JK2</span>, <span class='va'>b</span>, computeCI <span class='op'>=</span> <span class='cn'>FALSE</span>, nCores <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; ######### Compute encoding #########
#&gt; Number of individuals: 10
#&gt; Number of states: 4
#&gt; Basis type: bspline
#&gt; Number of basis functions: 6
#&gt; Number of cores: 1
#&gt; ---- Compute V matrix:
#&gt; 
#&gt; DONE in 0.62s
#&gt; ---- Compute U matrix:
#&gt; 
#&gt; DONE in 3.53s
#&gt; ---- Compute encoding: 
#&gt; DONE in 0.02s
#&gt; Run Time: 4.19s</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>encoding</span><span class='op'>)</span>
</div><div class='output co'>#&gt; #### FMCA
#&gt; 
#&gt; ## Data 
#&gt; Number of individuals: 10 
#&gt; Number of states: 4 
#&gt; Time Range: 0 to 6 
#&gt; States:  1 2 3 4 
#&gt; 
#&gt; ## Basis 
#&gt; Type: bspline 
#&gt; Number of basis functions: 6 
#&gt; 
#&gt; ## Outputs
#&gt; Eigenvalues:
#&gt;   4.637785 2.816563 2.793398 1.056381 0.9828662 0.625612 
#&gt; 
#&gt; Explained variance:
#&gt;   0.334 0.536 0.737 0.813 0.884 0.929 
#&gt; 
#&gt; Optimal encoding:
#&gt;                1          2           3          4
#&gt; [1,] -0.07784014  0.9022159  0.24355469  0.9472357
#&gt; [2,] -0.45074685 -0.8006644  0.60461057  0.4712409
#&gt; [3,] -0.19825488  0.5339617 -1.26237349  0.7857174
#&gt; [4,] -0.30988197 -0.8813381 -0.09140095  0.5483527
#&gt; [5,]  0.69532124 -0.2916668  0.28642504  0.1939174
#&gt; [6,]  0.38607934 -0.5892383  0.09890342 -0.1218741
#&gt; 
#&gt; Principal components:
#&gt;         [,1]       [,2]       [,3]       [,4]        [,5]        [,6]
#&gt; 1  0.1774185 -1.6596926  0.1665942  1.0931164  0.70077949 -1.02514668
#&gt; 2  2.8887787  1.6241755 -0.5820663  0.4830865 -1.06206713  0.62807799
#&gt; 3 -2.3506706  0.1748007 -2.3093265 -0.1257663 -0.17887866 -0.05405512
#&gt; 4 -0.8689081 -0.2386552  2.1940062 -1.1036073 -1.32461857 -1.27120061
#&gt; 5 -1.4634015  2.9280554  2.7585150  0.5531948  0.94109986  0.43530423
#&gt; 6 -1.4605043 -1.2959339 -0.3862482  1.8745450 -0.08968941  0.17340474
#&gt; 
#&gt; Total elapsed time: 4.19 s</div><div class='input'>
<span class='co'># plot eigenvalues</span>
<span class='fu'><a href='plotEigenvalues.html'>plotEigenvalues</a></span><span class='op'>(</span><span class='va'>encoding</span>, cumulative <span class='op'>=</span> <span class='cn'>TRUE</span>, normalize <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='img'><img src='cfda-package-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># plot the two first components</span>
<span class='fu'><a href='plotComponent.html'>plotComponent</a></span><span class='op'>(</span><span class='va'>encoding</span>, comp <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='cfda-package-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># plot the encoding using the first harmonic</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>encoding</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Removed 5 row(s) containing missing values (geom_path).</span></div><div class='img'><img src='cfda-package-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># extract the encoding using the first harmonic</span>
<span class='va'>encod</span> <span class='op'>&lt;-</span> <span class='fu'><a href='get_encoding.html'>get_encoding</a></span><span class='op'>(</span><span class='va'>encoding</span><span class='op'>)</span>


</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Cristian Preda, Quentin Grimonprez.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


