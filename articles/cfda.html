<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Categorical Functional Data Analysis • cfda</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Categorical Functional Data Analysis">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cfda</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.12.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/cfda.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/modal-inria/cfda/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Categorical Functional Data Analysis</h1>
                        <h4 data-toc-skip class="author">Cristian Preda,
Quentin Grimonprez</h4>
            
            <h4 data-toc-skip class="date">2024-11-22</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/modal-inria/cfda/blob/master/vignettes/cfda.Rmd" class="external-link"><code>vignettes/cfda.Rmd</code></a></small>
      <div class="hidden name"><code>cfda.Rmd</code></div>

    </div>

    
    
<p>See <a href="https://www.mdpi.com/2227-7390/9/23/3074" class="external-link uri">https://www.mdpi.com/2227-7390/9/23/3074</a> for more
details about the mathematical background and an overview of the
package.</p>
<div class="section level2">
<h2 id="dataset-simulation">Dataset Simulation<a class="anchor" aria-label="anchor" href="#dataset-simulation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://modal-inria.github.io/cfda/">cfda</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span></code></pre></div>
<p>We simulate the Jukes Cantor model of nucleotide replacement.</p>
<p>Denote the set of nucleotides:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo>=</mo><mo stretchy="false" form="prefix">{</mo><mi>A</mi><mo>,</mo><mi>T</mi><mo>,</mo><mi>G</mi><mo>,</mo><mi>C</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">E = \{A, T, G, C\}</annotation></semantics></math>.
A DNA sequence is seen as a string of nucleotides:
<code>ATGCATTAC</code>.</p>
<p>Each in the sequence is subject to mutation over time.</p>
<p>In the Jukes-Cantor model (1969), each site is a Markovian jump
process with continuous time having as generator:</p>
<p><span class="math display">$$ Q = \ \ \ \begin{array}{c|cccc}
&amp;A&amp;T&amp;G&amp;C \\ \hline
A&amp;-3\alpha&amp;\alpha&amp;\alpha&amp;\alpha\\
T&amp;\alpha&amp;-3\alpha&amp;\alpha&amp;\alpha\\
G&amp;\alpha&amp;\alpha&amp;-3\alpha&amp;\alpha\\
C&amp;\alpha&amp;\alpha&amp;\alpha&amp;-3\alpha\\ \hline
\end{array}$$</span></p>
<p>for some
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\alpha &gt;0</annotation></semantics></math>.</p>
<p>Let assume that the process is observed over the period
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><msub><mi>T</mi><mo>max</mo></msub><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[0,T_{\max}]</annotation></semantics></math>
in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
sites with the nucleotide
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t=0</annotation></semantics></math>.
In the following, nucleotides are recoded:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>↔</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">A\leftrightarrow 1</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>↔</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">T\leftrightarrow 2</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>↔</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">G\leftrightarrow 3</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>↔</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">C\leftrightarrow 4</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">PJK</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="va">K</span>, nrow <span class="op">=</span> <span class="va">K</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">3</span>, <span class="va">K</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">lambda_PJK</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Tmax</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span></span>
<span><span class="va">d_JK</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_Markov.html">generate_Markov</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, K <span class="op">=</span> <span class="fl">4</span>, P <span class="op">=</span> <span class="va">PJK</span>, lambda <span class="op">=</span> <span class="va">lambda_PJK</span>, Tmax <span class="op">=</span> <span class="va">Tmax</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">d_JK</span>, <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    id      time state</span></span>
<span><span class="co">## 1   1 0.0000000     A</span></span>
<span><span class="co">## 2   1 0.1983368     G</span></span>
<span><span class="co">## 3   1 0.2365287     T</span></span>
<span><span class="co">## 4   1 1.7001558     G</span></span>
<span><span class="co">## 5   1 2.1102854     A</span></span>
<span><span class="co">## 6   1 2.5485099     T</span></span>
<span><span class="co">## 7   1 3.2633724     G</span></span>
<span><span class="co">## 8   1 3.3448084     A</span></span>
<span><span class="co">## 9   1 3.4654739     T</span></span>
<span><span class="co">## 10  1 4.9614496     C</span></span></code></pre>
<p>The dataset is a data.frame with 3 columns: <code>id</code>,
<code>time</code>, <code>state</code>. <code>id</code> contains the id
of the different individuals (usually integers). <code>time</code>
contains the time values at which a change occurs, note that for each
individual, time values are ordered and start at 0. <code>state</code>
contains the state that appears at the given time, state must be
characters, factors, integers. This data format is used by the most part
of cfda’s functions.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/summary_cfd.html">summary_cfd</a></span><span class="op">(</span><span class="va">d_JK</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Number of rows: 1082 </span></span>
<span><span class="co">## Number of individuals: 100 </span></span>
<span><span class="co">## Time Range: 0 - 9.993531 </span></span>
<span><span class="co">## Same time start value for all ids: TRUE </span></span>
<span><span class="co">## Same time end value for all ids: FALSE </span></span>
<span><span class="co">## Number of states: 4 </span></span>
<span><span class="co">## States:</span></span>
<span><span class="co">##   A, C, G, T</span></span>
<span><span class="co">## Number of individuals visiting each state:</span></span>
<span><span class="co">##   A   C   G   T </span></span>
<span><span class="co">## 100  98  97  92</span></span></code></pre>
<p>We can compute the duration of each trajectory.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">duration</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_duration.html">compute_duration</a></span><span class="op">(</span><span class="va">d_JK</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">duration</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##        1        2        3        4        5        6 </span></span>
<span><span class="co">## 9.976904 7.812600 8.871661 8.357921 9.650790 9.993531</span></span></code></pre>
<p>All individuals has a different length. The computation of an optimal
encoding requires that the end time of each individual is the same
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mo>max</mo></msub><annotation encoding="application/x-tex">T_{\max}</annotation></semantics></math>),
this can be done with the following function:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_JKT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cut_data.html">cut_data</a></span><span class="op">(</span><span class="va">d_JK</span>, Tmax <span class="op">=</span> <span class="va">Tmax</span><span class="op">)</span></span></code></pre></div>
<p>Individuals can be plotted:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotData.html">plotData</a></span><span class="op">(</span><span class="va">d_JKT</span><span class="op">)</span></span></code></pre></div>
<p><img src="cfda_files/figure-html/plot-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="basic-statistics">Basic statistics<a class="anchor" aria-label="anchor" href="#basic-statistics"></a>
</h2>
<p>Generally, in categorical functional data analysis, the following
basic statistics are computed.</p>
<div class="section level3">
<h3 id="time-spent-in-each-state-over-a-period-of-length-t_max">Time spent in each state over a period of length
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mo>max</mo></msub><annotation encoding="application/x-tex">T_{\max}</annotation></semantics></math>:<a class="anchor" aria-label="anchor" href="#time-spent-in-each-state-over-a-period-of-length-t_max"></a>
</h3>
<p>For each individual, the time spent in each of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
states is computed.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">timeSpent</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_time_spent.html">compute_time_spent</a></span><span class="op">(</span><span class="va">d_JKT</span><span class="op">)</span></span>
<span><span class="va">timeSpent</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##           A         C        G        T</span></span>
<span><span class="co">## 1  2.827888 0.7229735 1.929005 4.520133</span></span>
<span><span class="co">## 2  3.951755 0.3545537 1.769637 3.924055</span></span>
<span><span class="co">## 3  1.958321 1.1951070 6.846572 0.000000</span></span>
<span><span class="co">## 4  4.718945 2.0622661 2.005165 1.213624</span></span>
<span><span class="co">## 5  3.200914 0.1618662 2.296325 4.340895</span></span>
<span><span class="co">## 6  4.214955 1.2124305 2.295326 2.277289</span></span>
<span><span class="co">## 7  2.757877 4.3517045 1.038824 1.851595</span></span>
<span><span class="co">## 8  3.826478 2.1324087 4.041113 0.000000</span></span>
<span><span class="co">## 9  1.687807 2.7519813 1.208147 4.352065</span></span>
<span><span class="co">## 10 4.788120 1.2389632 3.972917 0.000000</span></span></code></pre>
<p>The results can be plotted:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">timeSpent</span><span class="op">)</span></span></code></pre></div>
<p><img src="cfda_files/figure-html/unnamed-chunk-3-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="number-of-jumps-in-0t_max">Number of jumps in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><msub><mi>T</mi><mo>max</mo></msub><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[0,T_{\max}]</annotation></semantics></math>:<a class="anchor" aria-label="anchor" href="#number-of-jumps-in-0t_max"></a>
</h3>
<p>For each individual, the number of jumps occurring in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><msub><mi>T</mi><mo>max</mo></msub><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[0,T_{\max}]</annotation></semantics></math>
is computed.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nJump</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_number_jumps.html">compute_number_jumps</a></span><span class="op">(</span><span class="va">d_JK</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">nJump</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  1  2  3  4  5  6 </span></span>
<span><span class="co">## 17  9  3 13 10 13</span></span></code></pre>
<p>The results can be plotted:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">nJump</span><span class="op">)</span></span></code></pre></div>
<p><img src="cfda_files/figure-html/unnamed-chunk-5-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="probabilities-to-be-in-some-state-x-at-time-t-p_xt">Probabilities to be in some state
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>x</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p_{x}(t)</annotation></semantics></math>:<a class="anchor" aria-label="anchor" href="#probabilities-to-be-in-some-state-x-at-time-t-p_xt"></a>
</h3>
<p>An other interesting statistic is the evolution of the probability to
be in each state.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pt_evol</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_pt.html">estimate_pt</a></span><span class="op">(</span><span class="va">d_JKT</span><span class="op">)</span></span>
<span><span class="va">pt_evol</span><span class="op">$</span><span class="va">pt</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">K</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##   0 0.008 0.038 0.039 0.045 0.058 0.058 0.062 0.07 0.078</span></span>
<span><span class="co">## A 1  0.99  0.98  0.97  0.96  0.95  0.94  0.93 0.92  0.91</span></span>
<span><span class="co">## C 0  0.01  0.01  0.01  0.01  0.01  0.02  0.02 0.03  0.04</span></span>
<span><span class="co">## G 0  0.00  0.00  0.01  0.01  0.01  0.01  0.02 0.02  0.02</span></span>
<span><span class="co">## T 0  0.00  0.01  0.01  0.02  0.03  0.03  0.03 0.03  0.03</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pt_evol</span><span class="op">$</span><span class="va">t</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.000000000 0.007897421 0.038151747 0.038873269 0.044793148 0.058217068</span></span></code></pre>
<p>The output is a list with two elements: <code>t</code> the different
time values and <code>pt</code> a matrix where each row contains the
probability to be in a given state for all the time values. The result
can be plotted:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pt_evol</span>, ribbon <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="cfda_files/figure-html/unnamed-chunk-7-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="transitions-in-0t_max">Transitions in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><msub><mi>T</mi><mo>max</mo></msub><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[0,T_{\max}]</annotation></semantics></math>:<a class="anchor" aria-label="anchor" href="#transitions-in-0t_max"></a>
</h3>
<p>The transitions between states can been studied by computing a
frequency table counting the number of times each pair of states were
observed in successive observation times.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/statetable.html">statetable</a></span><span class="op">(</span><span class="va">d_JK</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    A   C  G   T</span></span>
<span><span class="co">## A  0 110 85 105</span></span>
<span><span class="co">## C 71   0 84  78</span></span>
<span><span class="co">## G 72  65  0  78</span></span>
<span><span class="co">## T 86  81 67   0</span></span></code></pre>
<p>Assuming that the data follows a Markov process, parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>
(transition probability matrix) and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
of the process can be estimated.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mark</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_Markov.html">estimate_Markov</a></span><span class="op">(</span><span class="va">d_JK</span><span class="op">)</span></span>
<span><span class="va">mark</span></span></code></pre></div>
<pre><code><span><span class="co">## $P</span></span>
<span><span class="co">##           A         C         G         T</span></span>
<span><span class="co">## A 0.0000000 0.3666667 0.2833333 0.3500000</span></span>
<span><span class="co">## C 0.3047210 0.0000000 0.3605150 0.3347639</span></span>
<span><span class="co">## G 0.3348837 0.3023256 0.0000000 0.3627907</span></span>
<span><span class="co">## T 0.3675214 0.3461538 0.2863248 0.0000000</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $lambda</span></span>
<span><span class="co">##        A        C        G        T </span></span>
<span><span class="co">## 1.062606 1.086185 1.079873 1.123472 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attr(,"class")</span></span>
<span><span class="co">## [1] "Markov"</span></span></code></pre>
<p>The estimated parameters are closed to the ones used. The results can
be plotted through a transition graph where each node corresponds to a
state with the mean time spent within (corresponding to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi>/</mi><mi>λ</mi></mrow><annotation encoding="application/x-tex">1/\lambda</annotation></semantics></math>)
and arrows correspond to transition probabilities between states.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mark</span><span class="op">)</span></span></code></pre></div>
<p><img src="cfda_files/figure-html/unnamed-chunk-10-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="encoding">Encoding<a class="anchor" aria-label="anchor" href="#encoding"></a>
</h2>
<div class="section level3">
<h3 id="concept">Concept<a class="anchor" aria-label="anchor" href="#concept"></a>
</h3>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>
is a continuous stochastic process with jumps. We define categorical
functional data as a set of sample paths of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>.</p>
<p><strong>cfda</strong> is seen as an extension of the multiple
correspondence analysis to a stochastic process.</p>
<p>The idea is to find a scalar real random variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>∈</mo><msub><mi>L</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Ω</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">z \in L_2(\Omega)</annotation></semantics></math>
that is the <em>most correlated</em> to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>=</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>X</mi><mi>t</mi></msub><mspace width="0.222em"></mspace><mo>:</mo><mspace width="0.222em"></mspace><mi>t</mi><mo>∈</mo><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><msub><mi>T</mi><mo>max</mo></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">{X} = \{X_{t}\ : \ t\in [0,T_{\max}]\}</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="mathematical-background">Mathematical Background<a class="anchor" aria-label="anchor" href="#mathematical-background"></a>
</h3>
<p>For a fixed
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>∈</mo><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><msub><mi>T</mi><mo>max</mo></msub><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">t\in [0,T_{\max}]</annotation></semantics></math>,
let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>E</mi><mi>t</mi></msup><annotation encoding="application/x-tex">E^{t}</annotation></semantics></math>
the projection operator,
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>E</mi><mi>t</mi></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>𝔼</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>X</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munder><mo>∑</mo><mrow><mi>x</mi><mo>∈</mo><mi>S</mi></mrow></munder><mrow><mi>𝔼</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>X</mi><mi>t</mi></msub><mo>=</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mn>𝟏</mn><mrow><msub><mi>X</mi><mi>t</mi></msub><mo>=</mo><mi>x</mi></mrow></msub></mrow></mrow><annotation encoding="application/x-tex">E^{t}(z) = \mathbb{E}(z|X_{t}) = \sum_{x\in S}{\mathbb{E}(z|X_t=x) \mathbf{1}_{X_t=x}}</annotation></semantics></math>
Then, the correlation coefficient between
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>t</mi></msub><annotation encoding="application/x-tex">X_{t}</annotation></semantics></math>
is:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>η</mi><mn>2</mn></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo>,</mo><msub><mi>X</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mi>v</mi><mi>a</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝔼</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>X</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>v</mi><mi>a</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">\eta^{2}(z, X_{t}) = \frac{var(\mathbb{E}(z|X_{t}))}{var(z)}</annotation></semantics></math></p>
<p>For
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>,</mo><mi>s</mi><mo>∈</mo><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><msub><mi>T</mi><mo>max</mo></msub><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">t, s \in [0,T_{\max}]</annotation></semantics></math>,
the <em>(simple) correspondence analysis</em> looks for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
such that it maximizes
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>η</mi><mn>2</mn></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo>,</mo><msub><mi>X</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msup><mi>η</mi><mn>2</mn></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo>,</mo><msub><mi>X</mi><mi>s</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\displaystyle\frac{1}{2}\left(\eta^{2}(z, X_{t})+\eta^{2}(z, X_{s})\right)</annotation></semantics></math>
and the solution is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>E</mi><mi>t</mi></msup><mo>+</mo><msup><mi>E</mi><mi>s</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mi>z</mi><mo>=</mo><mi>λ</mi><mi>z</mi></mrow><annotation encoding="application/x-tex">(E^{t}+E^{s})z = \lambda z</annotation></semantics></math><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
is called a <em>principal component</em>.</p>
<p>As an extension, the <em>functional correspondence analysis</em> is
defined as the solution of the optimization problem:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>arg</mo><munder><mo>max</mo><mi>z</mi></munder><mfrac><mn>1</mn><msub><mi>T</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></mfrac><msubsup><mo>∫</mo><mn>0</mn><msub><mi>T</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></msubsup><msup><mi>η</mi><mn>2</mn></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo>,</mo><msub><mi>X</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex"> \arg\max_{z}\displaystyle\frac{1}{T_{max}}\int_{0}^{T_{max}}\eta^{2}(z, X_{t})dt</annotation></semantics></math>
Solution:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∫</mo><mn>0</mn><msub><mi>T</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></msubsup><msup><mi>E</mi><mi>s</mi></msup><mi>z</mi><mspace width="0.222em"></mspace><mi>d</mi><mi>s</mi><mo>=</mo><mi>λ</mi><mi>z</mi></mrow><annotation encoding="application/x-tex">\int_{0}^{T_{max}}E^{s}z\ ds = \lambda z</annotation></semantics></math></p>
<p>Denote
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ξ</mi><mi>t</mi></msub><mo>=</mo><msup><mi>E</mi><mi>t</mi></msup><mi>z</mi></mrow><annotation encoding="application/x-tex">\xi_t = E^{t}z</annotation></semantics></math>,</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∫</mo><mn>0</mn><msub><mi>T</mi><mo>max</mo></msub></msubsup><mi>K</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>,</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>ξ</mi><mi>s</mi></msub><mspace width="0.222em"></mspace><mi>d</mi><mi>s</mi><mo>=</mo><mi>λ</mi><msub><mi>ξ</mi><mi>t</mi></msub><mo>,</mo><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mtext mathvariant="normal">with</mtext><mspace width="0.222em"></mspace><mi>K</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mi>E</mi><mi>t</mi></msup><msup><mi>E</mi><mi>s</mi></msup><mi>.</mi></mrow><annotation encoding="application/x-tex">\int_0^{T_{\max}}K(t,s)\xi_s\ ds = \lambda \xi_t, \ \ \ \ \mbox{with}\ K(s,t) = E^tE^s. </annotation></semantics></math></p>
<p>It follows that,
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ξ</mi><mi>t</mi></msub><mo>=</mo><munder><mo>∑</mo><mrow><mi>x</mi><mo>∈</mo><mi>S</mi></mrow></munder><msub><mi>a</mi><mi>x</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mn>𝟏</mn><mrow><msub><mi>X</mi><mi>t</mi></msub><mo>=</mo><mi>x</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\xi_{t} = \sum_{x\in S}a_{x}(t)\mathbf{1}_{X_t=x}</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>x</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>𝔼</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>X</mi><mi>t</mi></msub><mo>=</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mo>∀</mo><mi>x</mi><mo>∈</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">a_x(t) =\mathbb{E}(z|X_t= x), \ \ \forall x \in S</annotation></semantics></math>.</p>
<p>For each
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>∈</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">x\in S</annotation></semantics></math>,
the functions
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>x</mi></msub><mo>:</mo><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><msub><mi>T</mi><mo>max</mo></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo>→</mo><mi>ℝ</mi></mrow><annotation encoding="application/x-tex">a_x: [0,T_{\max}]\rightarrow \mathbb{R}</annotation></semantics></math>
are called <em>optimal encoding</em> of the state
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>.</p>
<p>The eigenvalue problem becomes in terms of encodings:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><msub><mi>a</mi><mi>x</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munder><mo>∑</mo><mrow><mi>y</mi><mo>∈</mo><mi>S</mi></mrow></munder><msubsup><mo>∫</mo><mn>0</mn><msub><mi>T</mi><mo>max</mo></msub></msubsup><mfrac><mrow><msub><mi>p</mi><mrow><mi>x</mi><mo>,</mo><mi>y</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>,</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msub><mi>p</mi><mi>x</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><msub><mi>a</mi><mi>y</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>d</mi><mi>s</mi><mo>,</mo><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mo>∀</mo><mi>x</mi><mo>∈</mo><mi>S</mi><mo>,</mo><mo>∀</mo><mi>t</mi><mo>∈</mo><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><msub><mi>T</mi><mo>max</mo></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\lambda a_x(t) = \sum_{y\in S}\displaystyle\int_{0}^{T_{\max}}\frac{p_{x,y}(t,s)}{p_x(t)}a_y(s)ds, \ \ \ \ \ \forall x \in S, \forall t\in [0,T_{\max}], </annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mrow><mi>x</mi><mo>,</mo><mi>y</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>,</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>ℙ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mi>t</mi></msub><mo>=</mo><mi>x</mi><mo>,</mo><msub><mi>X</mi><mi>s</mi></msub><mo>=</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p_{x,y}(t,s) = \mathbb{P}(X_t=x, X_s=y)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>x</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>ℙ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mi>t</mi></msub><mo>=</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p_x(t)= \mathbb{P}(X_t=x)</annotation></semantics></math>.</p>
<p>Under general conditions (continuity in probability of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>),
there exists
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><msub><mi>λ</mi><mi>i</mi></msub><msub><mo stretchy="false" form="postfix">}</mo><mrow><mi>i</mi><mo>≥</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\{\lambda_i\}_{i\geq1}</annotation></semantics></math>
positive eigen-values and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><msubsup><mi>a</mi><mi>x</mi><mi>i</mi></msubsup><msub><mo stretchy="false" form="postfix">}</mo><mrow><mi>i</mi><mo>≥</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\{a_x^i\}_{i\geq 1}</annotation></semantics></math>
eigen-functions.</p>
<p>The following expansion formula holds (Mercer thm.):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mrow><mi>x</mi><mo>,</mo><mi>y</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>,</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>p</mi><mi>x</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>p</mi><mi>y</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><munder><mo>∑</mo><mrow><mi>i</mi><mo>≥</mo><mn>1</mn></mrow></munder><msub><mi>λ</mi><mi>i</mi></msub><msubsup><mi>a</mi><mi>x</mi><mi>i</mi></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><msubsup><mi>a</mi><mi>y</mi><mi>i</mi></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p_{x,y}(t,s) = p_x(t)p_y(s)\sum_{i\geq 1}\lambda_{i}a^i_x(t)a^i_y(s)</annotation></semantics></math>
For
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">x=y</annotation></semantics></math>,
one obtains:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>x</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><munder><mo>∑</mo><mrow><mi>i</mi><mo>≥</mo><mn>1</mn></mrow></munder><msub><mi>λ</mi><mi>i</mi></msub><msubsup><mi>a</mi><mi>x</mi><mi>i</mi></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><msubsup><mi>a</mi><mi>y</mi><mi>i</mi></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">p_x(t) =\displaystyle\frac{1}{\displaystyle\sum_{i\geq 1}\lambda_{i}a^i_x(t)a^i_y(s)}</annotation></semantics></math></p>
<p>For the process
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>=</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>X</mi><mi>t</mi></msub><mo>,</mo><mi>t</mi><mo>∈</mo><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><mi>T</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">X = \{X_t, t\in[0, T]\}</annotation></semantics></math>
throughout the indicators
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mn>1</mn><mi>x</mi></msub><mo>=</mo><mo stretchy="false" form="prefix">{</mo><msub><mn>1</mn><mi>x</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>t</mi><mo>∈</mo><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><mi>T</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">1_x = \{1_x(t), t\in [0, T]\}</annotation></semantics></math>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mn>1</mn><mi>x</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munder><mo>∑</mo><mrow><mi>i</mi><mo>≥</mo><mn>1</mn></mrow></munder><msub><mi>z</mi><mi>i</mi></msub><msubsup><mi>a</mi><mi>i</mi><mi>x</mi></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mfrac><mn>1</mn><mrow><msub><mi>p</mi><mi>x</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">1_x(t)=\sum_{i\geq 1} z_i a_i^x(t)\frac{1}{p_x(t)}</annotation></semantics></math></p>
<p>We are interested in approximating the encoding functions,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mi>x</mi></msub><annotation encoding="application/x-tex">a_x</annotation></semantics></math>,
by</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>x</mi></msub><mo>≈</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>α</mi><mrow><mi>x</mi><mo>,</mo><mi>i</mi></mrow></msub><msub><mi>ϕ</mi><mi>i</mi></msub><mo>,</mo></mrow><annotation encoding="application/x-tex">a_{x} \approx \sum_{i=1}^m \alpha_{x,i}\phi_i, </annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝛂</mi><mi>𝐱</mi></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mrow><mi>x</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>α</mi><mrow><mi>x</mi><mo>,</mo><mi>m</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>∈</mo><msup><mi>ℝ</mi><mi>m</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{\alpha_x} = (\alpha_{x,1}, \ldots, \alpha_{x,m}) \in \mathbb{R}^m</annotation></semantics></math>
are the expansion coefficients onto a basis of functions defined on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><mi>T</mi><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[0,T]</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><msub><mi>ϕ</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>ϕ</mi><mi>m</mi></msub><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{\phi_1, \ldots, \phi_m\}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>≥</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">m \geq 1</annotation></semantics></math>.</p>
<p>The main result (Deville, 1982) is that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>α</mi><mi>K</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>∈</mo><msup><mi>ℝ</mi><mrow><mi>K</mi><mi>m</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\alpha = (\alpha_{1}, \ldots, \alpha_{K}) \in \mathbb{R}^{Km}</annotation></semantics></math>
is the solution of the following eigen-value problem:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>G</mi><mi>α</mi><mo>=</mo><mi>λ</mi><mi>α</mi><mo>,</mo></mrow><annotation encoding="application/x-tex">F^{-1}G\alpha = \lambda\alpha, </annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math>
the matrix defined by:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>=</mo><mi>c</mi><mi>o</mi><mi>v</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></msub><msub><mo stretchy="false" form="postfix">}</mo><mrow><mi>x</mi><mo>∈</mo><mi>S</mi><mo>;</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo>:</mo><mi>m</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">G = cov(\{V_{(x,i)}\}_{x\in S; i=1:m }),</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>=</mo><mi>𝔼</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>F</mi><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><msub><mo stretchy="false" form="postfix">}</mo><mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo>∈</mo><mi>S</mi><mo>;</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>=</mo><mn>1</mn><mo>:</mo><mi>m</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">F = \mathbb{E}\left(\{F_{(x,i),(y,j)}\}_{x,y\in S ; i,j=1:m}\right)</annotation></semantics></math>
with the random variables
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></msub><annotation encoding="application/x-tex">V_{(x,i)}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><annotation encoding="application/x-tex">F_{(x,i),(x,j)}</annotation></semantics></math>
defined by:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></msub><mo>=</mo><msubsup><mo>∫</mo><mn>0</mn><msub><mi>T</mi><mo>max</mo></msub></msubsup><msub><mi>ϕ</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mn>𝟏</mn><mi>x</mi></msub><mi>d</mi><mi>t</mi><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mtext mathvariant="normal">and</mtext><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><msub><mi>F</mi><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><mo>=</mo><msubsup><mo>∫</mo><mn>0</mn><msub><mi>T</mi><mo>max</mo></msub></msubsup><msub><mi>ϕ</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>ϕ</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mn>𝟏</mn><mi>x</mi></msub><msub><mn>𝟏</mn><mi>y</mi></msub><mi>d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">V_{(x,i)} = \int_{0}^{T_{\max}}\phi_i(t)\mathbf{1}_xdt \ \ \ \ \mbox{and}\ \ \ \
F_{(x,i), (y,j)} = \int_{0}^{T_{\max}}\phi_i(t)\phi_{j}(t)\mathbf{1}_x\mathbf{1}_y dt</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="application">Application<a class="anchor" aria-label="anchor" href="#application"></a>
</h3>
<p>Firstly, a basis of functions must be defined. We choose a B-splines
basis of order 4.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">basis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/fda/man/create.bspline.basis.html" class="external-link">create.bspline.basis</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">Tmax</span><span class="op">)</span>, nbasis <span class="op">=</span> <span class="va">m</span>, norder <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p>The optimal encoding is computed using:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fmca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_optimal_encoding.html">compute_optimal_encoding</a></span><span class="op">(</span><span class="va">d_JKT</span>, <span class="va">basis</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fmca</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## #### FMCA</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ## Data </span></span>
<span><span class="co">## Number of individuals: 100 </span></span>
<span><span class="co">## Number of states: 4 </span></span>
<span><span class="co">## Time Range: 0 to 10 </span></span>
<span><span class="co">## States:  1 2 3 4 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ## Basis </span></span>
<span><span class="co">## Type: bspline </span></span>
<span><span class="co">## Number of basis functions: 20 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ## Outputs</span></span>
<span><span class="co">## Eigenvalues:</span></span>
<span><span class="co">##   1.979971 1.87976 1.645708 1.497216 1.370031 1.316879 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Explained variance:</span></span>
<span><span class="co">##   0.078 0.152 0.217 0.276 0.33 0.382 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Optimal encoding:</span></span>
<span><span class="co">##                 A           C          G           T</span></span>
<span><span class="co">## [1,]  0.008180893 -0.58909343  0.4766992 -0.40020013</span></span>
<span><span class="co">## [2,]  0.014515597  0.52566581 -0.6950777  0.17637761</span></span>
<span><span class="co">## [3,] -0.009084061 -0.37942555  0.3985981 -0.02443008</span></span>
<span><span class="co">## [4,] -0.069652888 -0.67642599  0.3465354  0.57931109</span></span>
<span><span class="co">## [5,] -0.137618298 -0.14330188  0.2425508  0.40511150</span></span>
<span><span class="co">## [6,] -0.309208593  0.05087257 -0.1190275  0.32635795</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Principal components:</span></span>
<span><span class="co">##         [,1]       [,2]       [,3]         [,4]        [,5]        [,6]</span></span>
<span><span class="co">## 1  0.3704565 -0.7461855 -2.3826967 -0.817332429  0.06146912 -0.04419096</span></span>
<span><span class="co">## 2  0.6649154 -1.0872446 -1.8537400  0.007899832 -0.12504207  0.22016509</span></span>
<span><span class="co">## 3 -3.8819516  1.2971014  0.4180643 -0.183369945  0.75743237  0.31311758</span></span>
<span><span class="co">## 4  1.0941084  0.2797036 -0.6957583  1.762177272  0.54104766  2.23782009</span></span>
<span><span class="co">## 5  0.1747660 -2.4542637 -1.5757551 -0.288176353 -0.70892187  0.30844587</span></span>
<span><span class="co">## 6  0.1038436  1.1451010 -1.5909369  0.362205655 -0.75526301 -0.73604342</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Total elapsed time: 92.546 s</span></span></code></pre>
<p>By default this function computes bootstrap estimates of the encoding
functions in order to have a confidence interval. This is controlled by
the <code>computeCI</code> arguments. The output is a list containing
the different elements computed during the process:
<code>eigenvalues</code>, <code>pc</code>, <code>alpha</code>,
<code>F</code>, <code>G</code>, <code>V</code> and
<code>basisobj</code>. Note that <code>alpha</code>contains the
coefficients of the different encoding functions and <code>pc</code>the
principal components. These components can be used with classical
statistic methods (k-means, regression…).</p>
<p>The eigenvalues can be computed using:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotEigenvalues.html">plotEigenvalues</a></span><span class="op">(</span><span class="va">fmca</span>, cumulative <span class="op">=</span> <span class="cn">TRUE</span>, normalize <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="cfda_files/figure-html/unnamed-chunk-13-1.png" width="480" style="display: block; margin: auto;"></p>
<p>The first encoding function coefficients
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>’s:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fmca</span><span class="op">$</span><span class="va">alpha</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                  A           C           G            T</span></span>
<span><span class="co">##  [1,]  0.008180893 -0.58909343  0.47669920 -0.400200126</span></span>
<span><span class="co">##  [2,]  0.014515597  0.52566581 -0.69507769  0.176377614</span></span>
<span><span class="co">##  [3,] -0.009084061 -0.37942555  0.39859810 -0.024430084</span></span>
<span><span class="co">##  [4,] -0.069652888 -0.67642599  0.34653541  0.579311087</span></span>
<span><span class="co">##  [5,] -0.137618298 -0.14330188  0.24255075  0.405111498</span></span>
<span><span class="co">##  [6,] -0.309208593  0.05087257 -0.11902753  0.326357951</span></span>
<span><span class="co">##  [7,] -0.345337542  0.34510999 -0.01194049  0.059414703</span></span>
<span><span class="co">##  [8,]  0.411515257  0.18633306 -1.01542291 -0.004035332</span></span>
<span><span class="co">##  [9,]  0.066499135  0.38956072 -0.75060425  0.169082665</span></span>
<span><span class="co">## [10,]  0.442805356  0.32496793 -0.64164483  0.058034297</span></span>
<span><span class="co">## [11,]  0.137025350  0.66080911 -0.88516584 -0.033464535</span></span>
<span><span class="co">## [12,]  0.221128180  0.59734105 -0.61281881 -0.226002336</span></span>
<span><span class="co">## [13,] -0.023061199  0.41607362 -0.56939698 -0.137096230</span></span>
<span><span class="co">## [14,] -0.136462856  0.75635141 -0.34679873  0.019760886</span></span>
<span><span class="co">## [15,] -0.004898823 -0.45158932 -0.17783513  0.687183675</span></span>
<span><span class="co">## [16,]  0.211932955  0.14230107 -0.31096835  0.028668625</span></span>
<span><span class="co">## [17,] -0.164553063 -0.25713493 -0.23598583  0.760837273</span></span>
<span><span class="co">## [18,] -0.208792890  0.08073523  0.02635330  0.104904414</span></span>
<span><span class="co">## [19,] -0.166480097 -0.27899968 -0.25899954  0.692396872</span></span>
<span><span class="co">## [20,] -0.236574942 -0.06124286 -0.02169858  0.379020810</span></span></code></pre>
<p>The resulting encoding can be plotted:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fmca</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 3 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span></code></pre>
<p><img src="cfda_files/figure-html/unnamed-chunk-15-1.png" width="480" style="display: block; margin: auto;">
or extracted as a <em>fd</em> object (or matrix):</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">encoding</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_encoding.html">get_encoding</a></span><span class="op">(</span><span class="va">fmca</span>, fdObject <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Note that the first encoding mainly oppose the G state (in negative
values) to other states. So, on the first component, individuals with a
large negative values will tend to spend time in the G state after time
2.5.</p>
<p>By default, it plots (and returns) the first encoding functions.
Other encoding can be accessed with the <code>harm</code> argument.</p>
<p>A confidence interval can be plotted using the <code>addCI</code>
argument:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fmca</span>, addCI <span class="op">=</span> <span class="cn">TRUE</span>, coeff <span class="op">=</span> <span class="fl">2</span>, states <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span></span></code></pre></div>
<p><img src="cfda_files/figure-html/unnamed-chunk-17-1.png" width="480" style="display: block; margin: auto;"></p>
<p>Plot the two first components:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotComponent.html">plotComponent</a></span><span class="op">(</span><span class="va">fmca</span>, comp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, addNames <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="cfda_files/figure-html/unnamed-chunk-18-1.png" width="480" style="display: block; margin: auto;"></p>
<p>We can see that the individuals 3 and 14 have extreme ngative values
for the first component and are opposed to 67 and 84. By plotting them,
we can check the statement made on the first component meaning.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotData.html">plotData</a></span><span class="op">(</span><span class="va">d_JKT</span><span class="op">[</span><span class="va">d_JKT</span><span class="op">$</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">14</span>, <span class="fl">67</span>, <span class="fl">84</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="cfda_files/figure-html/unnamed-chunk-19-1.png" width="480" style="display: block; margin: auto;"></p>
<p>The components can be used for some other tasks such as clustering,
predicting,…</p>
<div class="section level4">
<h4 id="reconstruct-indicators">Reconstruct indicators<a class="anchor" aria-label="anchor" href="#reconstruct-indicators"></a>
</h4>
<p>With the encodings, the indicators can be reconstructed as
follows:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">indicators</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reconstructIndicators.html">reconstructIndicators</a></span><span class="op">(</span><span class="va">fmca</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Reconstruct data using 60 components (out of 80)"</span></span></code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">indicators</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          time id   stateA       stateC     stateG     stateT state</span></span>
<span><span class="co">## 1 0.000000000  1 1.231208 5.258831e-05 0.06839379 -0.2284427     G</span></span>
<span><span class="co">## 2 0.007897421  1 1.216876 5.248673e-05 0.07177822 -0.2270982     G</span></span>
<span><span class="co">## 3 0.038151747  1 1.123116 4.903944e-05 0.08600745 -0.2066952     G</span></span>
<span><span class="co">## 4 0.038873269  1 1.120306 4.888438e-05 0.08636713 -0.2058505     G</span></span>
<span><span class="co">## 5 0.044793148  1 1.096537 4.746114e-05 0.08934315 -0.1981844     G</span></span>
<span><span class="co">## 6 0.058217068  1 1.038911 4.316210e-05 0.09619778 -0.1755988     G</span></span></code></pre>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iInd</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="fu"><a href="../reference/plotData.html">plotData</a></span><span class="op">(</span><span class="va">d_JKT</span><span class="op">[</span><span class="va">d_JKT</span><span class="op">$</span><span class="va">id</span> <span class="op">==</span> <span class="va">iInd</span>, <span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="cfda_files/figure-html/unnamed-chunk-21-1.png" width="480" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotIndicatorsReconstruction.html">plotIndicatorsReconstruction</a></span><span class="op">(</span><span class="va">indicators</span>, id <span class="op">=</span> <span class="va">iInd</span><span class="op">)</span></span></code></pre></div>
<p><img src="cfda_files/figure-html/unnamed-chunk-21-2.png" width="480" style="display: block; margin: auto;"></p>
<p>We see that the reconstructed indicators gives the same inforamtion
as the true ones. Using more basis functions for computing encoding or
other basis can improve the approximation.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Cristian Preda, Quentin Grimonprez.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
